sit <- subset(spp, spp$Site == j)
for (l in levels(sit$Strategy)){
strat <- subset(sit, sit$Strategy == l)
lm <- lm(log(strat$a)~strat$One.over.kT)
N <- c(N,as.character(i),as.character(l),as.character(j),
summary(lm)$coefficients[2, 1],summary(lm)$coefficients[2, 2],
summary(lm)$coefficients[1, 1],summary(lm)$coefficients[1, 2])
}
}
#N <- split(N, ceiling(seq_along(N)/7))
#N <- data.frame(matrix(unlist(N), nrow=7, byrow=T))
}
split(N, ceiling(seq_along(N)/7))
N <- split(N, ceiling(seq_along(N)/7))
N
df <- ldply (N, data.frame)
View(df)
df <- data.frame(matrix(unlist(N), nrow=16, byrow=T))
View(df)
colnames(N) <- c("Genus","Site","Strategy","Ea","Ea_se","b0","b0_se")
N <- data.frame(matrix(unlist(N), nrow=16, byrow=T))
colnames(N) <- c("Genus","Site","Strategy","Ea","Ea_se","b0","b0_se")
View(N)
write.csv(N,paste0("../Results/FurtherMods/a_Ea_b0.csv"))
source('~/Documents/MSc/CMEECourseWork/Project/Code/aEa.R')
rm(list = ls())
dev.off()
library(plyr)
library(minpack.lm)
library(ggplot2)
setwd("~/Documents/GitHub/Locomotion-metabolism-and-acclimation/Code/")
source("multiplot.R")
dat <- read.csv("../Results/FurtherMods/a_Ea_b0.csv")
View(dat)
datCl <- subset(dat, dat$Genus == "Cloeon")
datCh <- subset(dat, dat$Genus == "Chironomus")
p <- ggplot(data = datCl, aes(x = Site, y = Ea)) + geom_point(aes(color=Site),size=I(3))+
theme_classic() + theme(axis.title=element_text(size=22)) + ylab("Ea") + theme(axis.text=element_text(size=15))
p <- p + geom_errorbar(aes(ymin = Ea - 1.96*Ea_se, ymax = Ea + 1.96*Ea_se, color = Site, width=.2))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20))
p <- p + scale_colour_manual(name="Site of Origin", values=c(rgb(0,0.5,1),rgb(1,0.25,0)))
p <- p + theme(strip.text.x = element_text(size = 17)) + theme(legend.position = "none")
p1 <- p + facet_grid( .~ Strategy, scales = "free", space = "free")
p1
View(datCl)
p
View(dat)
deltasE <- c()
deltasB <- c()
deltasEse <- c()
deltasBse <- c()
for (i in c(seq(5,8,1),seq(13,16,1))){
deltaE <- dat[i,4] - dat[i+4,4]
deltaB <- dat[i,6] - dat[i+4,6]
deltaEse <- dat[i,5] - dat[i+4,5]
deltaBse <- dat[i,7] - dat[i+4,7]
deltasE <- c(deltaE,deltasE)
deltasB <- c(deltaB,deltasB)
deltasEse <- c(deltaEse,deltasEse)
deltasBse <- c(deltaBse,deltasBse)
}
class(dat$Ea)
class(dat$Ea_se)
dat <- dat[,2:8]
datCl <- subset(dat, dat$Genus == "Cloeon")
datCh <- subset(dat, dat$Genus == "Chironomus")
deltasE <- c()
deltasB <- c()
deltasEse <- c()
deltasBse <- c()
for (i in c(seq(5,8,1),seq(13,16,1))){
deltaE <- dat[i,4] - dat[i+4,4]
deltaB <- dat[i,6] - dat[i+4,6]
deltaEse <- dat[i,5] - dat[i+4,5]
deltaBse <- dat[i,7] - dat[i+4,7]
deltasE <- c(deltaE,deltasE)
deltasB <- c(deltaB,deltasB)
deltasEse <- c(deltaEse,deltasEse)
deltasBse <- c(deltaBse,deltasBse)
}
Genus <- c(rep("Cloeon",4),rep("Chironomus",4))
Strategy <- rev(dat[c(1:4),3])
newdat <- as.data.frame(cbind.data.frame(Genus=as.character(Genus),
Strategy=as.character(Strategy),
deltasE=as.numeric(deltasE),
deltasEse=as.numeric(deltasEse),
deltasB=as.numeric(deltasB),
deltasBse=as.numeric(deltasBse)))
View(newdat)
c(seq(5,8,1),seq(13,16,1))
rm(list = ls())
dev.off()
library(plyr)
library(minpack.lm)
library(ggplot2)
library(data.table)
library(gridExtra)
library(grid)
setwd("~/Documents/GitHub/Locomotion-metabolism-and-acclimation/Code/")
source("multiplot.R")
dat <- read.csv("../Results/FurtherMods/a_Ea_b0.csv")
dat <- dat[,2:8]
datCl <- subset(dat, dat$Genus == "Cloeon")
datCh <- subset(dat, dat$Genus == "Chironomus")
View(dat)
source('~/Documents/MSc/CMEECourseWork/Project/Code/aEa.R')
rm(list = ls())
dev.off()
library(plyr)
library(minpack.lm)
library(ggplot2)
library(data.table)
library(gridExtra)
library(grid)
setwd("~/Documents/GitHub/Locomotion-metabolism-and-acclimation/Code/")
source("multiplot.R")
dat <- read.csv("../Results/FurtherMods/a_Ea_b0.csv")
dat <- dat[,2:8]
datCl <- subset(dat, dat$Genus == "Cloeon")
datCh <- subset(dat, dat$Genus == "Chironomus")
View(dat)
deltasE <- c()
deltasB <- c()
deltasEse <- c()
deltasBse <- c()
for (i in c(seq(5,8,1),seq(13,16,1))){
deltaE <- dat[i,4] - dat[i+4,4]
deltaB <- dat[i,6] - dat[i+4,6]
deltaEse <- dat[i,5] - dat[i+4,5]
deltaBse <- dat[i,7] - dat[i+4,7]
deltasE <- c(deltaE,deltasE)
deltasB <- c(deltaB,deltasB)
deltasEse <- c(deltaEse,deltasEse)
deltasBse <- c(deltaBse,deltasBse)
}
deltasE <- c()
deltasB <- c()
deltasEse <- c()
deltasBse <- c()
for (i in c(seq(5,8,1),seq(13,16,1))){
deltaE <- dat[i,4] - dat[i-4,4]
deltaB <- dat[i,6] - dat[i-4,6]
deltaEse <- dat[i,5] - dat[i-4,5]
deltaBse <- dat[i,7] - dat[i-4,7]
deltasE <- c(deltaE,deltasE)
deltasB <- c(deltaB,deltasB)
deltasEse <- c(deltaEse,deltasEse)
deltasBse <- c(deltaBse,deltasBse)
}
Genus <- c(rep("Cloeon",4),rep("Chironomus",4))
Strategy <- rev(dat[c(1:4),3])
newdat <- as.data.frame(cbind.data.frame(Genus=as.character(Genus),
Strategy=as.character(Strategy),
deltasE=as.numeric(deltasE),
deltasEse=as.numeric(deltasEse),
deltasB=as.numeric(deltasB),
deltasBse=as.numeric(deltasBse)))
View(newdat)
deltasE <- c()
deltasB <- c()
deltasEse <- c()
deltasBse <- c()
for (i in c(seq(5,8,1),seq(13,16,1))){
deltaE <- dat[i,4] - dat[i-4,4]
deltaB <- dat[i,6] - dat[i-4,6]
deltaEse <- dat[i,5] - dat[i-4,5]
deltaBse <- dat[i,7] - dat[i-4,7]
deltasE <- c(deltaE,deltasE)
deltasB <- c(deltaB,deltasB)
deltasEse <- c(deltaEse,deltasEse)
deltasBse <- c(deltaBse,deltasBse)
}
Genus <- c(rep("Cloeon",4),rep("Chironomus",4))
Strategy <- rev(dat[c(1:4),2])
newdat <- as.data.frame(cbind.data.frame(Genus=as.character(Genus),
Strategy=as.character(Strategy),
deltasE=as.numeric(deltasE),
deltasEse=as.numeric(deltasEse),
deltasB=as.numeric(deltasB),
deltasBse=as.numeric(deltasBse)))
View(newdat)
p <- ggplot(data=newdat, aes(x = Strategy, y = deltasE)) + geom_point(aes(),size=I(3))+
theme_classic() + theme(axis.title=element_text(size=22)) + ylab(expression(paste(Delta,"Ea(eV)"))) +
theme(axis.text=element_text(size=15))
p <- p + geom_errorbar(aes(ymin = deltasE - 1.96*deltasEse, ymax = deltasE + 1.96*deltasEse, width=.2))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20))
p <- p + scale_colour_manual(name="Site of Origin", values=c(rgb(0,0.5,1),rgb(1,0.25,0)))
p <- p + theme(strip.text.x = element_text(size = 17, face = 'italic')) + theme(legend.position = "none")
p <- p + geom_hline(yintercept=0, linetype="dotted", color = ("red"))
p5 <- p + facet_grid( .~ Genus, scales = "free", space = "free")
print(p5)
p <- ggplot(data=newdat, aes(x = Strategy, y = deltasB)) + geom_point(aes(),size=I(3))+
theme_classic() + theme(axis.title=element_text(size=22)) + ylab(expression(paste(Delta,"ln(B0)"))) +
theme(axis.text=element_text(size=15))
p <- p + geom_errorbar(aes(ymin = deltasB - 1.96*deltasBse, ymax = deltasB + 1.96*deltasBse, width=.2))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20))
p <- p + scale_colour_manual(name="Site of Origin", values=c(rgb(0,0.5,1),rgb(1,0.25,0)))
p <- p + theme(strip.text.x = element_text(size = 17, face = 'italic')) + theme(legend.position = "none")
p <- p + geom_hline(yintercept=0, linetype="dotted", color = ("red"))
p6 <- p + facet_grid( .~ Genus, scales = "free", space = "free")
print(p6)
rm(list = ls())
Chir_Po <- read.csv("../Results/FurtherMods/a_predictions_PortoChironomus_Vopt4_v1.csv")
Chir_Ev <- read.csv("../Results/FurtherMods/a_predictions_EvoraChironomus_Vopt4_v1.csv")
Dipt_Po <- read.csv("../Results/FurtherMods/a_predictions_PortoCloeon_Vopt4_v1.csv")
Dipt_Ev <- read.csv("../Results/FurtherMods/a_predictions_EvoraCloeon_Vopt4_v1.csv")
Site <- subset(Chir_Ev, Chir_Ev$Temperature > 13)
Site <- subset(Site, Site$Temperature < 15)
View(Site)
Site <- subset(Chir_Po, Chir_Po$Temperature > 11)
Site <- subset(Site, Site$Temperature < 13)
Chir_Po[Chir_Po$Temperature == 12.66332,]$sessile2D
Chir_Po[Chir_Po$Temperature >= 12.6633 && Chir_Po$Temperature <= 12.6634,]$sessile2D
Chir_Po[Chir_Po$Temperature >= 12.6633,]$sessile2D
Chir_Po[Chir_Po$Temperature %in% c(12.6633,12.6634),]$sessile2D
Chir_Po[Chir_Po$Temperature %in% c(12,13),]$sessile2D
Chir_Po[Chir_Po$Temperature >= 12.6633,]$sessile2D
View(Site)
Chir_Po[Chir_Po$Temperature >= 12.66332,]$sessile2D
Chir_Po[Chir_Po$Temperature >= 12.6633,]$sessile2D[1]
Chir_Po[Chir_Po$Temperature >= 12.6633,]$sessile2D[1]
log(Chir_Po[Chir_Po$Temperature >= 12.6633,]$sessile2D[1])
rm(list = ls())
#dev.off()
Chir_Po <- read.csv("../Results/FurtherMods/a_predictions_PortoChironomus_Vopt4_v1.csv")
Chir_Ev <- read.csv("../Results/FurtherMods/a_predictions_EvoraChironomus_Vopt4_v1.csv")
Dipt_Po <- read.csv("../Results/FurtherMods/a_predictions_PortoCloeon_Vopt4_v1.csv")
Dipt_Ev <- read.csv("../Results/FurtherMods/a_predictions_EvoraCloeon_Vopt4_v1.csv")
Strategies <- c(rep("s2D",200),rep("s3D",200),rep("a2D",200),rep("a3D",200))
Temperatures <- c(rep(Chir_Ev$Temperature,4))
GenusCh <- rep("Chironomus",800)
Evora <- rep("Evora", 800)
Porto <- rep("Porto", 800)
GenusCl <- rep("Cloeon",800)
StrategiesChPo <- c(Chir_Po$sessile2D,Chir_Po$sessile3D,Chir_Po$active2D,Chir_Po$active3D)
StrategiesChEv <- c(Chir_Ev$sessile2D,Chir_Ev$sessile3D,Chir_Ev$active2D,Chir_Ev$active3D)
StrategiesClPo <- c(Dipt_Po$sessile2D,Dipt_Po$sessile3D,Dipt_Po$active2D,Dipt_Po$active3D)
StrategiesClEv <- c(Dipt_Ev$sessile2D,Dipt_Ev$sessile3D,Dipt_Ev$active2D,Dipt_Ev$active3D)
StrategiesChPo <- cbind.data.frame(StrategiesChPo,Strategies,Temperatures,GenusCh,Porto)
StrategiesChEv <- cbind.data.frame(StrategiesChEv,Strategies,Temperatures,GenusCh,Evora)
StrategiesClPo <- cbind.data.frame(StrategiesClPo,Strategies,Temperatures,GenusCl,Porto)
StrategiesClEv <- cbind.data.frame(StrategiesClEv,Strategies,Temperatures,GenusCl,Evora)
colnames(StrategiesChPo) <- c("a","Strategy","Temperature","Genus","Site")
colnames(StrategiesChEv) <- c("a","Strategy","Temperature","Genus","Site")
colnames(StrategiesClPo) <- c("a","Strategy","Temperature","Genus","Site")
colnames(StrategiesClEv) <- c("a","Strategy","Temperature","Genus","Site")
Dat <- rbind.data.frame(StrategiesChPo,StrategiesChEv,StrategiesClPo,StrategiesClEv)
k <- 8.617*(10^-5)
Dat$One.over.kT <- 1/(k*(Dat$Temperature+273.15))
N <-c()
for (i in unique(Dat$Genus)){
spp <- subset(Dat, Dat$Genus == i)
for (j in levels(spp$Site)){
sit <- subset(spp, spp$Site == j)
for (l in levels(sit$Strategy)){
strat <- subset(sit, sit$Strategy == l)
lm <- lm(log(strat$a)~strat$One.over.kT)
N <- c(N,as.character(i),as.character(l),as.character(j),
-summary(lm)$coefficients[2, 1],summary(lm)$coefficients[2, 2],
exp(summary(lm)$coefficients[1, 1]),exp(summary(lm)$coefficients[1, 2]))
}
}
}
N <- split(N, ceiling(seq_along(N)/7))
N <- data.frame(matrix(unlist(N), nrow=16, byrow=T))
colnames(N) <- c("Genus","Strategy","Site","Ea","Ea_se","b0","b0_se")
write.csv(N,paste0("../Results/FurtherMods/a_Ea_b0.csv"))
rm(list = ls())
#dev.off()
Chir_Po <- read.csv("../Results/FurtherMods/a_predictions_PortoChironomus_Vopt4_v1.csv")
Chir_Ev <- read.csv("../Results/FurtherMods/a_predictions_EvoraChironomus_Vopt4_v1.csv")
Dipt_Po <- read.csv("../Results/FurtherMods/a_predictions_PortoCloeon_Vopt4_v1.csv")
Dipt_Ev <- read.csv("../Results/FurtherMods/a_predictions_EvoraCloeon_Vopt4_v1.csv")
Strategies <- c(rep("s2D",200),rep("s3D",200),rep("a2D",200),rep("a3D",200))
Temperatures <- c(rep(Chir_Ev$Temperature,4))
GenusCh <- rep("Chironomus",800)
Evora <- rep("Evora", 800)
Porto <- rep("Porto", 800)
GenusCl <- rep("Cloeon",800)
StrategiesChPo <- c(Chir_Po$sessile2D,Chir_Po$sessile3D,Chir_Po$active2D,Chir_Po$active3D)
StrategiesChEv <- c(Chir_Ev$sessile2D,Chir_Ev$sessile3D,Chir_Ev$active2D,Chir_Ev$active3D)
StrategiesClPo <- c(Dipt_Po$sessile2D,Dipt_Po$sessile3D,Dipt_Po$active2D,Dipt_Po$active3D)
StrategiesClEv <- c(Dipt_Ev$sessile2D,Dipt_Ev$sessile3D,Dipt_Ev$active2D,Dipt_Ev$active3D)
StrategiesChPo <- cbind.data.frame(StrategiesChPo,Strategies,Temperatures,GenusCh,Porto)
StrategiesChEv <- cbind.data.frame(StrategiesChEv,Strategies,Temperatures,GenusCh,Evora)
StrategiesClPo <- cbind.data.frame(StrategiesClPo,Strategies,Temperatures,GenusCl,Porto)
StrategiesClEv <- cbind.data.frame(StrategiesClEv,Strategies,Temperatures,GenusCl,Evora)
colnames(StrategiesChPo) <- c("a","Strategy","Temperature","Genus","Site")
colnames(StrategiesChEv) <- c("a","Strategy","Temperature","Genus","Site")
colnames(StrategiesClPo) <- c("a","Strategy","Temperature","Genus","Site")
colnames(StrategiesClEv) <- c("a","Strategy","Temperature","Genus","Site")
Dat <- rbind.data.frame(StrategiesChPo,StrategiesChEv,StrategiesClPo,StrategiesClEv)
k <- 8.617*(10^-5)
Dat$One.over.kT <- 1/(k*(Dat$Temperature+273.15))
N <-c()
for (i in unique(Dat$Genus)){
spp <- subset(Dat, Dat$Genus == i)
for (j in levels(spp$Site)){
sit <- subset(spp, spp$Site == j)
for (l in levels(sit$Strategy)){
strat <- subset(sit, sit$Strategy == l)
lm <- lm(log(strat$a)~strat$One.over.kT)
N <- c(N,as.character(i),as.character(l),as.character(j),
-summary(lm)$coefficients[2, 1],summary(lm)$coefficients[2, 2],
summary(lm)$coefficients[1, 1],summary(lm)$coefficients[1, 2])
}
}
}
N <- split(N, ceiling(seq_along(N)/7))
N <- data.frame(matrix(unlist(N), nrow=16, byrow=T))
colnames(N) <- c("Genus","Strategy","Site","Ea","Ea_se","b0","b0_se")
write.csv(N,paste0("../Results/FurtherMods/a_Ea_b0.csv"))
Chir_Po[Chir_Po$Temperature >= 12.6633,]$sessile2D[1]
Chir_Po[Chir_Po$Temperature >= 12.6633,]$sessile3D[1]
Chir_Po[Chir_Po$Temperature >= 12.6633,]$active2D[1]
Chir_Po[Chir_Po$Temperature >= 12.6633,]$active3D[1]
Chir_Ev[Chir_Ev$Temperature >= 14.8743,]$sessile2D[1]
Chir_Ev[Chir_Ev$Temperature >= 14.8743,]$sessile3D[1]
Chir_Ev[Chir_Ev$Temperature >= 14.8743,]$active2D[1]
Chir_Ev[Chir_Ev$Temperature >= 14.8743,]$active3D[1]
Dipt_Po[Dipt_Po$Temperature >= 12.6633,]$sessile2D[1]
Dipt_Po[Dipt_Po$Temperature >= 12.6633,]$sessile3D[1]
Dipt_Po[Dipt_Po$Temperature >= 12.6633,]$active2D[1]
Dipt_Po[Dipt_Po$Temperature >= 12.6633,]$active3D[1]
Dipt_Ev[Dipt_Ev$Temperature >= 14.8743,]$sessile2D[1]
Dipt_Ev[Dipt_Ev$Temperature >= 14.8743,]$sessile3D[1]
Dipt_Ev[Dipt_Ev$Temperature >= 14.8743,]$active2D[1]
Dipt_Ev[Dipt_Ev$Temperature >= 14.8743,]$active3D[1]
rm(list = ls())
dev.off()
library(plyr)
library(minpack.lm)
library(ggplot2)
library(data.table)
library(gridExtra)
library(grid)
setwd("~/Documents/GitHub/Locomotion-metabolism-and-acclimation/Code/")
source("multiplot.R")
dat <- read.csv("../Results/FurtherMods/a_Ea_b0.csv")
dat <- dat[,2:8]
datCl <- subset(dat, dat$Genus == "Cloeon")
datCh <- subset(dat, dat$Genus == "Chironomus")
View(dat)
deltasE <- c()
deltasB <- c()
deltasEse <- c()
deltasBse <- c()
for (i in c(seq(5,8,1),seq(13,16,1))){
deltaE <- dat[i,4] - dat[i-4,4]
deltaB <- dat[i,6] - dat[i-4,6]
deltaEse <- dat[i,5] - dat[i-4,5]
deltaBse <- dat[i,7] - dat[i-4,7]
deltasE <- c(deltaE,deltasE)
deltasB <- c(deltaB,deltasB)
deltasEse <- c(deltaEse,deltasEse)
deltasBse <- c(deltaBse,deltasBse)
}
Genus <- c(rep("Cloeon",4),rep("Chironomus",4))
Strategy <- rev(dat[c(1:4),2])
newdat <- as.data.frame(cbind.data.frame(Genus=as.character(Genus),
Strategy=as.character(Strategy),
deltasE=as.numeric(deltasE),
deltasEse=as.numeric(deltasEse),
deltasB=as.numeric(deltasB),
deltasBse=as.numeric(deltasBse)))
p <- ggplot(data=newdat, aes(x = Strategy, y = deltasE)) + geom_point(aes(),size=I(3))+
theme_classic() + theme(axis.title=element_text(size=22)) + ylab(expression(paste(Delta,"Ea(eV)"))) +
theme(axis.text=element_text(size=15))
p <- p + geom_errorbar(aes(ymin = deltasE - 1.96*deltasEse, ymax = deltasE + 1.96*deltasEse, width=.2))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20))
p <- p + scale_colour_manual(name="Site of Origin", values=c(rgb(0,0.5,1),rgb(1,0.25,0)))
p <- p + theme(strip.text.x = element_text(size = 17, face = 'italic')) + theme(legend.position = "none")
p <- p + geom_hline(yintercept=0, linetype="dotted", color = ("red"))
p5 <- p + facet_grid( .~ Genus, scales = "free", space = "free")
print(p5)
dat <- read.csv("../Results/FurtherMods/a_Ea_b0.csv")
dat <- dat[,2:8]
dat$Ea <- -dat$Ea
deltasE <- c()
deltasB <- c()
deltasEse <- c()
deltasBse <- c()
for (i in c(seq(5,8,1),seq(13,16,1))){
deltaE <- dat[i,4] - dat[i-4,4]
deltaB <- dat[i,6] - dat[i-4,6]
deltaEse <- dat[i,5] - dat[i-4,5]
deltaBse <- dat[i,7] - dat[i-4,7]
deltasE <- c(deltaE,deltasE)
deltasB <- c(deltaB,deltasB)
deltasEse <- c(deltaEse,deltasEse)
deltasBse <- c(deltaBse,deltasBse)
}
Genus <- c(rep("Cloeon",4),rep("Chironomus",4))
Strategy <- rev(dat[c(1:4),2])
newdat <- as.data.frame(cbind.data.frame(Genus=as.character(Genus),
Strategy=as.character(Strategy),
deltasE=as.numeric(deltasE),
deltasEse=as.numeric(deltasEse),
deltasB=as.numeric(deltasB),
deltasBse=as.numeric(deltasBse)))
p <- ggplot(data=newdat, aes(x = Strategy, y = deltasE)) + geom_point(aes(),size=I(3))+
theme_classic() + theme(axis.title=element_text(size=22)) + ylab(expression(paste(Delta,"Ea(eV)"))) +
theme(axis.text=element_text(size=15))
p <- p + geom_errorbar(aes(ymin = deltasE - 1.96*deltasEse, ymax = deltasE + 1.96*deltasEse, width=.2))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20))
p <- p + scale_colour_manual(name="Site of Origin", values=c(rgb(0,0.5,1),rgb(1,0.25,0)))
p <- p + theme(strip.text.x = element_text(size = 17, face = 'italic')) + theme(legend.position = "none")
p <- p + geom_hline(yintercept=0, linetype="dotted", color = ("red"))
p5 <- p + facet_grid( .~ Genus, scales = "free", space = "free")
print(p5)
p <- ggplot(data=newdat, aes(x = Strategy, y = deltasB)) + geom_point(aes(),size=I(3))+
theme_classic() + theme(axis.title=element_text(size=22)) + ylab(expression(paste(Delta,"ln(B0)"))) +
theme(axis.text=element_text(size=15))
p <- p + geom_errorbar(aes(ymin = deltasB - 1.96*deltasBse, ymax = deltasB + 1.96*deltasBse, width=.2))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20))
p <- p + scale_colour_manual(name="Site of Origin", values=c(rgb(0,0.5,1),rgb(1,0.25,0)))
p <- p + theme(strip.text.x = element_text(size = 17, face = 'italic')) + theme(legend.position = "none")
p <- p + geom_hline(yintercept=0, linetype="dotted", color = ("red"))
p6 <- p + facet_grid( .~ Genus, scales = "free", space = "free")
print(p6)
Chir_Po <- read.csv("../Results/FurtherMods/a_predictions_PortoChironomus_Vopt4_v1.csv")
Chir_Ev <- read.csv("../Results/FurtherMods/a_predictions_EvoraChironomus_Vopt4_v1.csv")
Dipt_Po <- read.csv("../Results/FurtherMods/a_predictions_PortoCloeon_Vopt4_v1.csv")
Dipt_Ev <- read.csv("../Results/FurtherMods/a_predictions_EvoraCloeon_Vopt4_v1.csv")
Dipt_Po[Dipt_Po$Temperature >= 12.6633,]$active2D[1]
Dipt_Ev[Dipt_Ev$Temperature >= 14.8743,]$active2D[1]
Dipt_Ev[Dipt_Ev$Temperature >= 14.8743,]$active3D[1]
Dipt_Po[Dipt_Po$Temperature >= 12.6633,]$active3D[1]
Dipt_Ev[Dipt_Ev$Temperature >= 14.8743,]$sessile2D[1]
Dipt_Ev[Dipt_Ev$Temperature >= 14.8743,]$sessile3D[1]
rm(list = ls())
dev.off()
library(plyr)
library(minpack.lm)
library(ggplot2)
library(data.table)
library(gridExtra)
library(grid)
setwd("~/Documents/GitHub/Locomotion-metabolism-and-acclimation/Code/")
source("multiplot.R")
dat <- read.csv("../Results/FurtherMods/a_Ea_b0.csv")
dat <- dat[,2:8]
dat$Ea <- -dat$Ea
datCl <- subset(dat, dat$Genus == "Cloeon")
datCh <- subset(dat, dat$Genus == "Chironomus")
deltasE <- c()
deltasB <- c()
deltasEse <- c()
deltasBse <- c()
for (i in c(seq(5,8,1),seq(13,16,1))){
deltaE <- dat[i,4] - dat[i-4,4]
deltaB <- dat[i,6] - dat[i-4,6]
deltaEse <- dat[i,5] - dat[i-4,5]
deltaBse <- dat[i,7] - dat[i-4,7]
deltasE <- c(deltaE,deltasE)
deltasB <- c(deltaB,deltasB)
deltasEse <- c(deltaEse,deltasEse)
deltasBse <- c(deltaBse,deltasBse)
}
Genus <- c(rep("Cloeon",4),rep("Chironomus",4))
Strategy <- rev(dat[c(1:4),2])
newdat <- as.data.frame(cbind.data.frame(Genus=as.character(Genus),
Strategy=as.character(Strategy),
deltasE=as.numeric(deltasE),
deltasEse=as.numeric(deltasEse),
deltasB=as.numeric(deltasB),
deltasBse=as.numeric(deltasBse)))
p <- ggplot(data=newdat, aes(x = Strategy, y = deltasE)) + geom_point(aes(),size=I(3))+
theme_classic() + theme(axis.title=element_text(size=22)) + ylab(expression(paste(Delta,"Ea(eV)"))) +
theme(axis.text=element_text(size=15))
p <- p + geom_errorbar(aes(ymin = deltasE - 1.96*deltasEse, ymax = deltasE + 1.96*deltasEse, width=.2))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20))
p <- p + scale_colour_manual(name="Site of Origin", values=c(rgb(0,0.5,1),rgb(1,0.25,0)))
p <- p + theme(strip.text.x = element_text(size = 17, face = 'italic')) + theme(legend.position = "none")
p <- p + geom_hline(yintercept=0, linetype="dotted", color = ("red"))
p5 <- p + facet_grid( .~ Genus, scales = "free", space = "free")
print(p5)
p <- ggplot(data=newdat, aes(x = Strategy, y = deltasB)) + geom_point(aes(),size=I(3))+
theme_classic() + theme(axis.title=element_text(size=22)) + ylab(expression(paste(Delta,"ln(B0)"))) +
theme(axis.text=element_text(size=15))
p <- p + geom_errorbar(aes(ymin = deltasB - 1.96*deltasBse, ymax = deltasB + 1.96*deltasBse, width=.2))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20))
p <- p + scale_colour_manual(name="Site of Origin", values=c(rgb(0,0.5,1),rgb(1,0.25,0)))
p <- p + theme(strip.text.x = element_text(size = 17, face = 'italic')) + theme(legend.position = "none")
p <- p + geom_hline(yintercept=0, linetype="dotted", color = ("red"))
p6 <- p + facet_grid( .~ Genus, scales = "free", space = "free")
print(p6)
tiff("../Results/FurtherMods/deltaE_point.tiff", width = 15, height = 10, units = 'cm', res = 300, compression = 'lzw')
print(p5)
dev.off()
dev.off()
tiff("../Results/FurtherMods/deltaB0_point.tiff", width = 15, height = 10, units = 'cm', res = 300, compression = 'lzw')
print(p6)
dev.off()
tiff("../Results/FurtherMods/delta_point.tiff", width = 30, height = 10, units = 'cm', res = 300, compression = 'lzw')
multiplot(p5, p6, cols=2)
dev.off()
p <- ggplot(data=newdat, aes(x = Strategy, y = deltasB)) + geom_point(aes(),size=I(3))+
theme_classic() + theme(axis.title=element_text(size=22)) + ylab(expression(paste(Delta,"B0"))) +
theme(axis.text=element_text(size=15))
p <- p + geom_errorbar(aes(ymin = deltasB - 1.96*deltasBse, ymax = deltasB + 1.96*deltasBse, width=.2))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20))
p <- p + scale_colour_manual(name="Site of Origin", values=c(rgb(0,0.5,1),rgb(1,0.25,0)))
p <- p + theme(strip.text.x = element_text(size = 17, face = 'italic')) + theme(legend.position = "none")
p <- p + geom_hline(yintercept=0, linetype="dotted", color = ("red"))
p6 <- p + facet_grid( .~ Genus, scales = "free", space = "free")
tiff("../Results/FurtherMods/deltaB0_point.tiff", width = 15, height = 10, units = 'cm', res = 300, compression = 'lzw')
print(p6)
dev.off()
tiff("../Results/FurtherMods/delta_point.tiff", width = 30, height = 10, units = 'cm', res = 300, compression = 'lzw')
multiplot(p5, p6, cols=2)
dev.off()
