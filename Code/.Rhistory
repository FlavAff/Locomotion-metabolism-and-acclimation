Er <- values[values$Genus == resource,]$Ea_end
Ec <- values[values$Genus == consumer,]$Ea_end
GMRr <- power(values[values$Genus == resource,]$B0_end)
GMRc <- power(values[values$Genus == consumer,]$B0_end)
GCOTr <- GCOT(mr/1000)
GCOTc <- GCOT(mc/1000)
b0c <- Vopt(GMRr,mr/1000,GCOTr)
b0r <- Vopt(GMRc,mc/1000,GCOTc)
Temp <- seq(from = 273.15, to = 400.15, length.out = 200)
sessile2D <- sessile.search.rate.2D(b0c = b0c, mc = mc, Ec = Ec, bc = bc, mr = mr, Temp = Temp, d0 = d0, Pd = Pd2, i = i, c = c)
sessile3D <- sessile.search.rate.3D(b0c = b0c, mc = mc, Ec = Ec, bc = bc, mr = mr, Temp = Temp, d0 = d0, Pd = Pd3, i = i, c = c)
active2D <- active.search.rate.2D(b0c = b0c, mc = mc, Ec = Ec, bc = bc, b0r = b0r, mr = mr, Er = Er, br = br, Temp = Temp, d0 = d0, Pd = Pd2, i = i, c = c)
active3D <- active.search.rate.3D(b0c = b0c, mc = mc, Ec = Ec, bc = bc, b0r = b0r, mr = mr, Er = Er, br = br, Temp = Temp, d0 = d0, Pd = Pd3, i = i, c = c)
Temperature <- Temp - 273.15
aS2D <- data.frame(Temperature,sessile2D)
aS3D <- data.frame(Temperature,sessile3D)
aA2D <- data.frame(Temperature,active2D)
aA3D <- data.frame(Temperature,active3D)
p <- ggplot() + theme_classic() +
theme(axis.title=element_text(size=22)) +
geom_line(data = aS2D, aes(x = Temperature, y = sessile2D, colour = "2D sessile prey"), size = I(1), alpha = .4) +
xlab(expression(paste("Temperature (", degree, C, ")"))) +
ylab(expression(paste("Search rate")))
p <- p + geom_line(data = aS3D, aes(x = Temperature, y = sessile3D, colour = "3D sessile prey"), size = I(1), alpha = 0.4)
p <- p + geom_line(data = aA2D, aes(x = Temperature, y = active2D, colour = "2D active prey"), size = I(1), alpha = 0.4)
p <- p + geom_line(data = aA3D, aes(x = Temperature, y = active3D, colour = "3D active prey"), size = I(2), alpha = 1)
p <- p + scale_color_discrete(name = "Model Strategy") + xlim(5,45) + ylim(0,maxi)#+ ggtitle(paste(sit,"Model Predictions")) + theme(plot.title = element_text(face="bold"))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20)) + theme(axis.text=element_text(size=15))
#open the pdf and put the plot in it
#pdf(paste0("../Results/FurtherMods/Corrected2/",sit,resource,"as_Vopt4_v1.pdf"))
#print(p)
#dev.off()
a.results <- data.frame(Temperature,sessile2D,sessile3D,active2D,active3D)
write.csv(a.results,paste0("../Results/FurtherMods/a_predictions_",sit,resource,"_Vopt4_v1.csv"))
return(p)
}
SiteSearchRate.Vopt4.version1("Porto",strio,dipt,"Sympetrum","Cloeon", maxi = 3)
SiteSearchRate.Vopt4.version1("Porto",strio,dipt,"Sympetrum","Cloeon", maxi = 40)
source('~/Documents/GitHub/Locomotion-metabolism-and-acclimation/Code/a_plot_fun2.R')
SiteSearchRate.Vopt4.version1("Porto",strio,dipt,"Sympetrum","Cloeon", maxi = 40)
SiteSearchRate.Vopt4.version1("Porto",strio,dipt,"Sympetrum","Cloeon", maxi = 3)
Temp <- seq(from = 273.15, to = 418.15, length.out = 200)
Temperature <- Temp - 273.15
max(Temperature)
source('~/Documents/GitHub/Locomotion-metabolism-and-acclimation/Code/a_plot_fun2.R')
SiteSearchRate.Vopt4.version1("Porto",strio,dipt,"Sympetrum","Cloeon", maxi = 3)
SiteSearchRate.Vopt4.version1("Porto",strio,dipt,"Sympetrum","Cloeon", maxi = 20)
SiteSearchRate.Vopt4.version1("Porto",strio,dipt,"Sympetrum","Cloeon", maxi = 40)
SiteSearchRate.Vopt4.version1("Porto",strio,dipt,"Sympetrum","Cloeon", maxi = 100)
SiteSearchRate.Vopt4.version1("Porto",strio,dipt,"Sympetrum","Cloeon", maxi = 150)
SiteSearchRate.Vopt4.version1("Porto",strio,dipt,"Sympetrum","Cloeon", maxi = 200)
source('~/Documents/GitHub/Locomotion-metabolism-and-acclimation/Code/a_plot_fun2.R')
SiteSearchRate.Vopt4.version1("Porto",strio,dipt,"Sympetrum","Cloeon", maxi = 3)
rm(list = ls())
dev.off()
library(plyr)
library(minpack.lm)
library(ggplot2)
library(data.table)
library(gridExtra)
setwd("~/Documents/GitHub/Locomotion-metabolism-and-acclimation/Code/")
source("DataClean.R")
rm(list=setdiff(ls(), c("chir","dipt","strio","k")))
source("Schoolfields2.R")
source("plot_functions.R")
source("further_models_fun.R")
source("multiplot.R")
values <- read.csv("../Results/SchoolField/Revised/UsedValuesMean.csv")
values$site <- factor(values$site, levels = c("Penalara","Jaca","Toledo","Evora","Porto","Murcia"))
chir_values <- subset(values, values$Genus == "Chironomus")
dipt_values <- subset(values, values$Genus == "Cloeon")
stri_values <- subset(values, values$Genus == "Sympetrum")
Plot_two_curves_v0 <- function(spp1,spp2,locations,spp1_values,spp2_values,GCOT1,GCOT2,m1,m2,preycol){
for (i in locations){
#get the predicted values for both models
Tempe <- seq(from=283.15, to = 318.15, by = 0.5)
Masss2 <- seq(from = as.numeric(min(spp2[spp2$site == i,]$Mass)), to = as.numeric(max(spp2[spp2$site == i,]$Mass)), length.out = length(Tempe))
d1 <- SchoolfieldNo(B0 = spp1_values[spp1_values$site == i,]$B0_end,
E = spp1_values[spp1_values$site == i,]$Ea_end,
Ed = spp1_values[spp1_values$site == i,]$Ed_end,
TempH = spp1_values[spp1_values$site == i,]$Tpk_end,
#TempN = spp1_values[spp1_values$site == i,]$Site.April.median.temp + 273.15,
Temp = Tempe)
d2 <- SchoolfieldM(B0 = spp2_values[spp2_values$site == i,]$B0_end,
b = spp2_values[spp2_values$site == i,]$b,
m = Masss2,
E = spp2_values[spp2_values$site == i,]$Ea_end,
Ed = spp2_values[spp2_values$site == i,]$Ed_end,
TempH = spp2_values[spp2_values$site == i,]$Tpk_end,
#TempN = spp2_values[spp2_values$site == i,]$Site.April.median.temp + 273.15,
Temp = Tempe)
Temperature <- seq(from = 10, to = 45, length.out = length(d1))
d1 <- 0.3*Vopt(power(d1),m1,GCOT1)
d2 <- 0.3*Vopt(power(d2),m2,GCOT2)
#create plottable data
Model1 <- data.frame(Temperature, exp(d1))
Model2 <- data.frame(Temperature, exp(d2))
p <- ggplot() + theme_classic() + ylim(0,1.5) +
theme(axis.title=element_text(size=22)) +
geom_line(data = Model1, aes(x = Temperature, y = exp(d1), colour = spp1$genus[1]), size = I(2), alpha = 0.7) +
xlab(expression(paste("Temperature (", degree, C, ")"))) +
ylab(expression(paste("Speed (m/s)")))
p <- p + geom_line(data = Model2, aes(x = Temperature, y = exp(d2), colour = spp2$genus[1]), size = I(2), alpha = 0.7)
#p <- p + scale_color_discrete(name = "Genus") #+ ggtitle(paste("Predator - Prey TPCs from",i)) +
if (locations == "Evora" && preycol == "orange"){
p <- p + ggtitle("Warm site (Evora)") + theme(title=element_text(size=22)) + theme(plot.title = element_text(hjust=.5))
}
p <- p + scale_colour_manual(name="Genus", values=c(preycol,"darkred"))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20)) + theme(axis.text=element_text(size=15))
#theme(plot.title = element_text(face="bold"))
#open the pdf and put the plot in it
#pdf(paste0("../Results/SchoolField/Revised/VS",i,spp2$genus[1],"SchoolTPCsv0.pdf"))
#print(p)
#dev.off()
return(p)
#print(paste("difference in b0 for",i,exp(d1)-exp(d2)))
}
}
chir_GCOT <- GCOT(mean(chir$Mass)/1000)
dipt_GCOT <- GCOT(mean(dipt$Mass)/1000)
stri_GCOT <- GCOT(mean(strio$Mass)/1000)
chir_m <- mean(chir$Mass)/1000
dipt_m <- mean(dipt$Mass)/1000
stri_m <- mean(strio$Mass)/1000
pTolCh <- Plot_two_curves_v0(spp1 = strio,spp2 = chir,locations = c("Porto"),stri_values,chir_values,stri_GCOT,chir_GCOT,stri_m,chir_m,"orange")
pEvoCh <- Plot_two_curves_v0(spp1 = strio,spp2 = chir,locations = c("Evora"),stri_values,chir_values,stri_GCOT,chir_GCOT,stri_m,chir_m,"orange")
pTolCl <- Plot_two_curves_v0(spp1 = strio,spp2 = dipt,locations = c("Porto"),stri_values,dipt_values,stri_GCOT,dipt_GCOT,stri_m,dipt_m,"pink")
pEvoCl <- Plot_two_curves_v0(spp1 = strio,spp2 = dipt,locations = c("Evora"),stri_values,dipt_values,stri_GCOT,dipt_GCOT,stri_m,dipt_m,"pink")
pTolCh <- pTolCh + ggtitle("Cool site (Toledo)") + theme(title=element_text(size=22)) + theme(plot.title = element_text(hjust=.5)) +
theme(axis.title.x=element_blank()) + theme(legend.position = "none") + theme(axis.title.y=element_blank()) +
theme(plot.margin=unit(c(0.5,1.5,1,4),"cm")) +
geom_rect(aes(xmin=24.992, xmax=45, ymin=0, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCh <- pEvoCh + theme(axis.title.x=element_blank()) + theme(axis.title.y=element_blank())+
theme(plot.margin=unit(c(0.5,0.5,1,1),"cm")) +
geom_rect(aes(xmin=30.192, xmax=45, ymin=0, ymax=Inf), size = I(2), alpha = 0.2)
pTolCl <- pTolCl + theme(legend.position = "none") + theme(axis.title.x=element_blank()) +
theme(axis.title.y=element_blank()) + theme(plot.margin=unit(c(0.5,1.5,1.5,4),"cm")) +
geom_rect(aes(xmin=24.992, xmax=45, ymin=0, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCl <- pEvoCl + theme(axis.title.y=element_blank()) + theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(0.5,0.5,1.5,1),"cm")) +
geom_rect(aes(xmin=30.192, xmax=45, ymin=0, ymax=Inf), size = I(2), alpha = 0.2)
multiplot(pTolCh,pTolCl,pEvoCh,pEvoCl, cols =2,
labs=list("Temperature (Â°C)","Speed (m/s)"))
Plot_two_curves_v0 <- function(spp1,spp2,locations,spp1_values,spp2_values,GCOT1,GCOT2,m1,m2,preycol){
for (i in locations){
#get the predicted values for both models
Tempe <- seq(from=283.15, to = 318.15, by = 0.5)
Masss2 <- seq(from = as.numeric(min(spp2[spp2$site == i,]$Mass)), to = as.numeric(max(spp2[spp2$site == i,]$Mass)), length.out = length(Tempe))
d1 <- SchoolfieldNo(B0 = spp1_values[spp1_values$site == i,]$B0_end,
E = spp1_values[spp1_values$site == i,]$Ea_end,
Ed = spp1_values[spp1_values$site == i,]$Ed_end,
TempH = spp1_values[spp1_values$site == i,]$Tpk_end,
#TempN = spp1_values[spp1_values$site == i,]$Site.April.median.temp + 273.15,
Temp = Tempe)
d2 <- SchoolfieldM(B0 = spp2_values[spp2_values$site == i,]$B0_end,
b = spp2_values[spp2_values$site == i,]$b,
m = Masss2,
E = spp2_values[spp2_values$site == i,]$Ea_end,
Ed = spp2_values[spp2_values$site == i,]$Ed_end,
TempH = spp2_values[spp2_values$site == i,]$Tpk_end,
#TempN = spp2_values[spp2_values$site == i,]$Site.April.median.temp + 273.15,
Temp = Tempe)
Temperature <- seq(from = 10, to = 45, length.out = length(d1))
d1 <- 0.3*Vopt(power(d1),m1,GCOT1)
d2 <- 0.3*Vopt(power(d2),m2,GCOT2)
#create plottable data
Model1 <- data.frame(Temperature, d1)
Model2 <- data.frame(Temperature, d2)
p <- ggplot() + theme_classic() + ylim(0,1.5) +
theme(axis.title=element_text(size=22)) +
geom_line(data = Model1, aes(x = Temperature, y = d1, colour = spp1$genus[1]), size = I(2), alpha = 0.7) +
xlab(expression(paste("Temperature (", degree, C, ")"))) +
ylab(expression(paste("Speed (m/s)")))
p <- p + geom_line(data = Model2, aes(x = Temperature, y = d2, colour = spp2$genus[1]), size = I(2), alpha = 0.7)
#p <- p + scale_color_discrete(name = "Genus") #+ ggtitle(paste("Predator - Prey TPCs from",i)) +
if (locations == "Evora" && preycol == "orange"){
p <- p + ggtitle("Warm site (Evora)") + theme(title=element_text(size=22)) + theme(plot.title = element_text(hjust=.5))
}
p <- p + scale_colour_manual(name="Genus", values=c(preycol,"darkred"))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20)) + theme(axis.text=element_text(size=15))
#theme(plot.title = element_text(face="bold"))
#open the pdf and put the plot in it
#pdf(paste0("../Results/SchoolField/Revised/VS",i,spp2$genus[1],"SchoolTPCsv0.pdf"))
#print(p)
#dev.off()
return(p)
#print(paste("difference in b0 for",i,exp(d1)-exp(d2)))
}
}
chir_GCOT <- GCOT(mean(chir$Mass)/1000)
dipt_GCOT <- GCOT(mean(dipt$Mass)/1000)
stri_GCOT <- GCOT(mean(strio$Mass)/1000)
chir_m <- mean(chir$Mass)/1000
dipt_m <- mean(dipt$Mass)/1000
stri_m <- mean(strio$Mass)/1000
pTolCh <- Plot_two_curves_v0(spp1 = strio,spp2 = chir,locations = c("Porto"),stri_values,chir_values,stri_GCOT,chir_GCOT,stri_m,chir_m,"orange")
pEvoCh <- Plot_two_curves_v0(spp1 = strio,spp2 = chir,locations = c("Evora"),stri_values,chir_values,stri_GCOT,chir_GCOT,stri_m,chir_m,"orange")
pTolCl <- Plot_two_curves_v0(spp1 = strio,spp2 = dipt,locations = c("Porto"),stri_values,dipt_values,stri_GCOT,dipt_GCOT,stri_m,dipt_m,"pink")
pEvoCl <- Plot_two_curves_v0(spp1 = strio,spp2 = dipt,locations = c("Evora"),stri_values,dipt_values,stri_GCOT,dipt_GCOT,stri_m,dipt_m,"pink")
pTolCh <- pTolCh + ggtitle("Cool site (Toledo)") + theme(title=element_text(size=22)) + theme(plot.title = element_text(hjust=.5)) +
theme(axis.title.x=element_blank()) + theme(legend.position = "none") + theme(axis.title.y=element_blank()) +
theme(plot.margin=unit(c(0.5,1.5,1,4),"cm")) +
geom_rect(aes(xmin=24.992, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCh <- pEvoCh + theme(axis.title.x=element_blank()) + theme(axis.title.y=element_blank())+
theme(plot.margin=unit(c(0.5,0.5,1,1),"cm")) +
geom_rect(aes(xmin=30.192, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pTolCl <- pTolCl + theme(legend.position = "none") + theme(axis.title.x=element_blank()) +
theme(axis.title.y=element_blank()) + theme(plot.margin=unit(c(0.5,1.5,1.5,4),"cm")) +
geom_rect(aes(xmin=24.992, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCl <- pEvoCl + theme(axis.title.y=element_blank()) + theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(0.5,0.5,1.5,1),"cm")) +
geom_rect(aes(xmin=30.192, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
multiplot(pTolCh,pTolCl,pEvoCh,pEvoCl, cols =2,
labs=list("Temperature (Â°C)","Speed (m/s)"))
Plot_two_curves_v0 <- function(spp1,spp2,locations,spp1_values,spp2_values,GCOT1,GCOT2,m1,m2,preycol){
for (i in locations){
#get the predicted values for both models
Tempe <- seq(from=283.15, to = 318.15, by = 0.5)
Masss2 <- seq(from = as.numeric(min(spp2[spp2$site == i,]$Mass)), to = as.numeric(max(spp2[spp2$site == i,]$Mass)), length.out = length(Tempe))
d1 <- SchoolfieldNo(B0 = spp1_values[spp1_values$site == i,]$B0_end,
E = spp1_values[spp1_values$site == i,]$Ea_end,
Ed = spp1_values[spp1_values$site == i,]$Ed_end,
TempH = spp1_values[spp1_values$site == i,]$Tpk_end,
#TempN = spp1_values[spp1_values$site == i,]$Site.April.median.temp + 273.15,
Temp = Tempe)
d2 <- SchoolfieldM(B0 = spp2_values[spp2_values$site == i,]$B0_end,
b = spp2_values[spp2_values$site == i,]$b,
m = Masss2,
E = spp2_values[spp2_values$site == i,]$Ea_end,
Ed = spp2_values[spp2_values$site == i,]$Ed_end,
TempH = spp2_values[spp2_values$site == i,]$Tpk_end,
#TempN = spp2_values[spp2_values$site == i,]$Site.April.median.temp + 273.15,
Temp = Tempe)
Temperature <- seq(from = 10, to = 45, length.out = length(d1))
d1 <- 0.3*Vopt(power(d1),m1,GCOT1)
d2 <- 0.3*Vopt(power(d2),m2,GCOT2)
#create plottable data
Model1 <- data.frame(Temperature, d1)
Model2 <- data.frame(Temperature, d2)
p <- ggplot() + theme_classic() + #ylim(0,1.5) +
theme(axis.title=element_text(size=22)) +
geom_line(data = Model1, aes(x = Temperature, y = d1, colour = spp1$genus[1]), size = I(2), alpha = 0.7) +
xlab(expression(paste("Temperature (", degree, C, ")"))) +
ylab(expression(paste("Speed (m/s)")))
p <- p + geom_line(data = Model2, aes(x = Temperature, y = d2, colour = spp2$genus[1]), size = I(2), alpha = 0.7)
#p <- p + scale_color_discrete(name = "Genus") #+ ggtitle(paste("Predator - Prey TPCs from",i)) +
if (locations == "Evora" && preycol == "orange"){
p <- p + ggtitle("Warm site (Evora)") + theme(title=element_text(size=22)) + theme(plot.title = element_text(hjust=.5))
}
p <- p + scale_colour_manual(name="Genus", values=c(preycol,"darkred"))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20)) + theme(axis.text=element_text(size=15))
#theme(plot.title = element_text(face="bold"))
#open the pdf and put the plot in it
#pdf(paste0("../Results/SchoolField/Revised/VS",i,spp2$genus[1],"SchoolTPCsv0.pdf"))
#print(p)
#dev.off()
return(p)
#print(paste("difference in b0 for",i,exp(d1)-exp(d2)))
}
}
chir_GCOT <- GCOT(mean(chir$Mass)/1000)
dipt_GCOT <- GCOT(mean(dipt$Mass)/1000)
stri_GCOT <- GCOT(mean(strio$Mass)/1000)
chir_m <- mean(chir$Mass)/1000
dipt_m <- mean(dipt$Mass)/1000
stri_m <- mean(strio$Mass)/1000
pTolCh <- Plot_two_curves_v0(spp1 = strio,spp2 = chir,locations = c("Porto"),stri_values,chir_values,stri_GCOT,chir_GCOT,stri_m,chir_m,"orange")
pEvoCh <- Plot_two_curves_v0(spp1 = strio,spp2 = chir,locations = c("Evora"),stri_values,chir_values,stri_GCOT,chir_GCOT,stri_m,chir_m,"orange")
pTolCl <- Plot_two_curves_v0(spp1 = strio,spp2 = dipt,locations = c("Porto"),stri_values,dipt_values,stri_GCOT,dipt_GCOT,stri_m,dipt_m,"pink")
pEvoCl <- Plot_two_curves_v0(spp1 = strio,spp2 = dipt,locations = c("Evora"),stri_values,dipt_values,stri_GCOT,dipt_GCOT,stri_m,dipt_m,"pink")
pTolCh <- pTolCh + ggtitle("Cool site (Toledo)") + theme(title=element_text(size=22)) + theme(plot.title = element_text(hjust=.5)) +
theme(axis.title.x=element_blank()) + theme(legend.position = "none") + theme(axis.title.y=element_blank()) +
theme(plot.margin=unit(c(0.5,1.5,1,4),"cm")) +
geom_rect(aes(xmin=24.992, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCh <- pEvoCh + theme(axis.title.x=element_blank()) + theme(axis.title.y=element_blank())+
theme(plot.margin=unit(c(0.5,0.5,1,1),"cm")) +
geom_rect(aes(xmin=30.192, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pTolCl <- pTolCl + theme(legend.position = "none") + theme(axis.title.x=element_blank()) +
theme(axis.title.y=element_blank()) + theme(plot.margin=unit(c(0.5,1.5,1.5,4),"cm")) +
geom_rect(aes(xmin=24.992, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCl <- pEvoCl + theme(axis.title.y=element_blank()) + theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(0.5,0.5,1.5,1),"cm")) +
geom_rect(aes(xmin=30.192, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
multiplot(pTolCh,pTolCl,pEvoCh,pEvoCl, cols =2,
labs=list("Temperature (Â°C)","Speed (m/s)"))
Plot_two_curves_v0 <- function(spp1,spp2,locations,spp1_values,spp2_values,GCOT1,GCOT2,m1,m2,preycol){
for (i in locations){
#get the predicted values for both models
Tempe <- seq(from=283.15, to = 318.15, by = 0.5)
Masss2 <- seq(from = as.numeric(min(spp2[spp2$site == i,]$Mass)), to = as.numeric(max(spp2[spp2$site == i,]$Mass)), length.out = length(Tempe))
d1 <- SchoolfieldNo(B0 = spp1_values[spp1_values$site == i,]$B0_end,
E = spp1_values[spp1_values$site == i,]$Ea_end,
Ed = spp1_values[spp1_values$site == i,]$Ed_end,
TempH = spp1_values[spp1_values$site == i,]$Tpk_end,
#TempN = spp1_values[spp1_values$site == i,]$Site.April.median.temp + 273.15,
Temp = Tempe)
d2 <- SchoolfieldM(B0 = spp2_values[spp2_values$site == i,]$B0_end,
b = spp2_values[spp2_values$site == i,]$b,
m = Masss2,
E = spp2_values[spp2_values$site == i,]$Ea_end,
Ed = spp2_values[spp2_values$site == i,]$Ed_end,
TempH = spp2_values[spp2_values$site == i,]$Tpk_end,
#TempN = spp2_values[spp2_values$site == i,]$Site.April.median.temp + 273.15,
Temp = Tempe)
Temperature <- seq(from = 10, to = 45, length.out = length(d1))
d1 <- 0.3*Vopt(power(d1),m1,GCOT1)
d2 <- 0.3*Vopt(power(d2),m2,GCOT2)
#create plottable data
Model1 <- data.frame(Temperature, d1)
Model2 <- data.frame(Temperature, d2)
p <- ggplot() + theme_classic() + ylim(-2.5,.5) +
theme(axis.title=element_text(size=22)) +
geom_line(data = Model1, aes(x = Temperature, y = d1, colour = spp1$genus[1]), size = I(2), alpha = 0.7) +
xlab(expression(paste("Temperature (", degree, C, ")"))) +
ylab(expression(paste("Speed (m/s)")))
p <- p + geom_line(data = Model2, aes(x = Temperature, y = d2, colour = spp2$genus[1]), size = I(2), alpha = 0.7)
#p <- p + scale_color_discrete(name = "Genus") #+ ggtitle(paste("Predator - Prey TPCs from",i)) +
if (locations == "Evora" && preycol == "orange"){
p <- p + ggtitle("Warm site (Evora)") + theme(title=element_text(size=22)) + theme(plot.title = element_text(hjust=.5))
}
p <- p + scale_colour_manual(name="Genus", values=c(preycol,"darkred"))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20)) + theme(axis.text=element_text(size=15))
#theme(plot.title = element_text(face="bold"))
#open the pdf and put the plot in it
#pdf(paste0("../Results/SchoolField/Revised/VS",i,spp2$genus[1],"SchoolTPCsv0.pdf"))
#print(p)
#dev.off()
return(p)
#print(paste("difference in b0 for",i,exp(d1)-exp(d2)))
}
}
chir_GCOT <- GCOT(mean(chir$Mass)/1000)
dipt_GCOT <- GCOT(mean(dipt$Mass)/1000)
stri_GCOT <- GCOT(mean(strio$Mass)/1000)
chir_m <- mean(chir$Mass)/1000
dipt_m <- mean(dipt$Mass)/1000
stri_m <- mean(strio$Mass)/1000
pTolCh <- Plot_two_curves_v0(spp1 = strio,spp2 = chir,locations = c("Porto"),stri_values,chir_values,stri_GCOT,chir_GCOT,stri_m,chir_m,"orange")
pEvoCh <- Plot_two_curves_v0(spp1 = strio,spp2 = chir,locations = c("Evora"),stri_values,chir_values,stri_GCOT,chir_GCOT,stri_m,chir_m,"orange")
pTolCl <- Plot_two_curves_v0(spp1 = strio,spp2 = dipt,locations = c("Porto"),stri_values,dipt_values,stri_GCOT,dipt_GCOT,stri_m,dipt_m,"pink")
pEvoCl <- Plot_two_curves_v0(spp1 = strio,spp2 = dipt,locations = c("Evora"),stri_values,dipt_values,stri_GCOT,dipt_GCOT,stri_m,dipt_m,"pink")
pTolCh <- pTolCh + ggtitle("Cool site (Toledo)") + theme(title=element_text(size=22)) + theme(plot.title = element_text(hjust=.5)) +
theme(axis.title.x=element_blank()) + theme(legend.position = "none") + theme(axis.title.y=element_blank()) +
theme(plot.margin=unit(c(0.5,1.5,1,4),"cm")) +
geom_rect(aes(xmin=24.992, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCh <- pEvoCh + theme(axis.title.x=element_blank()) + theme(axis.title.y=element_blank())+
theme(plot.margin=unit(c(0.5,0.5,1,1),"cm")) +
geom_rect(aes(xmin=30.192, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pTolCl <- pTolCl + theme(legend.position = "none") + theme(axis.title.x=element_blank()) +
theme(axis.title.y=element_blank()) + theme(plot.margin=unit(c(0.5,1.5,1.5,4),"cm")) +
geom_rect(aes(xmin=24.992, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCl <- pEvoCl + theme(axis.title.y=element_blank()) + theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(0.5,0.5,1.5,1),"cm")) +
geom_rect(aes(xmin=30.192, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
multiplot(pTolCh,pTolCl,pEvoCh,pEvoCl, cols =2,
labs=list("Temperature (Â°C)","Speed (m/s)"))
dev.off()
pEvCh <- pEvCh + theme(legend.position = "none")
pEvCl <- pEvCl + theme(legend.position = "none")
rm(list = ls())
dev.off()
library(plyr)
library(minpack.lm)
library(ggplot2)
library(data.table)
library(gridExtra)
setwd("~/Documents/GitHub/Locomotion-metabolism-and-acclimation/Code/")
source("DataClean.R")
rm(list=setdiff(ls(), c("chir","dipt","strio","k")))
source("Schoolfields2.R")
source("plot_functions.R")
source("further_models_fun.R")
source("multiplot.R")
values <- read.csv("../Results/SchoolField/Revised/UsedValuesMean.csv")
values$site <- factor(values$site, levels = c("Penalara","Jaca","Toledo","Evora","Porto","Murcia"))
chir_values <- subset(values, values$Genus == "Chironomus")
dipt_values <- subset(values, values$Genus == "Cloeon")
stri_values <- subset(values, values$Genus == "Sympetrum")
Plot_two_curves_v0 <- function(spp1,spp2,locations,spp1_values,spp2_values,GCOT1,GCOT2,m1,m2,preycol){
for (i in locations){
#get the predicted values for both models
Tempe <- seq(from=283.15, to = 318.15, by = 0.5)
Masss2 <- seq(from = as.numeric(min(spp2[spp2$site == i,]$Mass)), to = as.numeric(max(spp2[spp2$site == i,]$Mass)), length.out = length(Tempe))
d1 <- SchoolfieldNo(B0 = spp1_values[spp1_values$site == i,]$B0_end,
E = spp1_values[spp1_values$site == i,]$Ea_end,
Ed = spp1_values[spp1_values$site == i,]$Ed_end,
TempH = spp1_values[spp1_values$site == i,]$Tpk_end,
#TempN = spp1_values[spp1_values$site == i,]$Site.April.median.temp + 273.15,
Temp = Tempe)
d2 <- SchoolfieldM(B0 = spp2_values[spp2_values$site == i,]$B0_end,
b = spp2_values[spp2_values$site == i,]$b,
m = Masss2,
E = spp2_values[spp2_values$site == i,]$Ea_end,
Ed = spp2_values[spp2_values$site == i,]$Ed_end,
TempH = spp2_values[spp2_values$site == i,]$Tpk_end,
#TempN = spp2_values[spp2_values$site == i,]$Site.April.median.temp + 273.15,
Temp = Tempe)
Temperature <- seq(from = 10, to = 45, length.out = length(d1))
d1 <- 0.3*Vopt(power(d1),m1,GCOT1)
d2 <- 0.3*Vopt(power(d2),m2,GCOT2)
#create plottable data
Model1 <- data.frame(Temperature, exp(d1))
Model2 <- data.frame(Temperature, exp(d2))
p <- ggplot() + theme_classic() + ylim(0,1.5) +
theme(axis.title=element_text(size=22)) +
geom_line(data = Model1, aes(x = Temperature, y = exp(d1), colour = spp1$genus[1]), size = I(2), alpha = 0.7) +
xlab(expression(paste("Temperature (", degree, C, ")"))) +
ylab(expression(paste("Speed (m/s)")))
p <- p + geom_line(data = Model2, aes(x = Temperature, y = exp(d2), colour = spp2$genus[1]), size = I(2), alpha = 0.7)
#p <- p + scale_color_discrete(name = "Genus") #+ ggtitle(paste("Predator - Prey TPCs from",i)) +
if (locations == "Evora" && preycol == "orange"){
p <- p + ggtitle("Warm site (Evora)") + theme(title=element_text(size=22)) + theme(plot.title = element_text(hjust=.5))
}
p <- p + scale_colour_manual(name="Genus", values=c(preycol,"darkred"))
p <- p + theme(legend.text=element_text(size=17)) + theme(legend.title=element_text(size=20)) + theme(axis.text=element_text(size=15))
#theme(plot.title = element_text(face="bold"))
#open the pdf and put the plot in it
#pdf(paste0("../Results/SchoolField/Revised/VS",i,spp2$genus[1],"SchoolTPCsv0.pdf"))
#print(p)
#dev.off()
return(p)
#print(paste("difference in b0 for",i,exp(d1)-exp(d2)))
}
}
chir_GCOT <- GCOT(mean(chir$Mass)/1000)
dipt_GCOT <- GCOT(mean(dipt$Mass)/1000)
stri_GCOT <- GCOT(mean(strio$Mass)/1000)
chir_m <- mean(chir$Mass)/1000
dipt_m <- mean(dipt$Mass)/1000
stri_m <- mean(strio$Mass)/1000
pTolCh <- Plot_two_curves_v0(spp1 = strio,spp2 = chir,locations = c("Toledo"),stri_values,chir_values,stri_GCOT,chir_GCOT,stri_m,chir_m,"orange")
pEvoCh <- Plot_two_curves_v0(spp1 = strio,spp2 = chir,locations = c("Evora"),stri_values,chir_values,stri_GCOT,chir_GCOT,stri_m,chir_m,"orange")
pTolCl <- Plot_two_curves_v0(spp1 = strio,spp2 = dipt,locations = c("Toledo"),stri_values,dipt_values,stri_GCOT,dipt_GCOT,stri_m,dipt_m,"pink")
pEvoCl <- Plot_two_curves_v0(spp1 = strio,spp2 = dipt,locations = c("Evora"),stri_values,dipt_values,stri_GCOT,dipt_GCOT,stri_m,dipt_m,"pink")
pTolCh <- pTolCh + ggtitle("Cool site (Toledo)") + theme(title=element_text(size=22)) + theme(plot.title = element_text(hjust=.5)) +
theme(axis.title.x=element_blank()) + theme(legend.position = "none") + theme(axis.title.y=element_blank()) +
theme(plot.margin=unit(c(0.5,1.5,1,4),"cm")) +
geom_rect(aes(xmin=33.6, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCh <- pEvoCh + theme(axis.title.x=element_blank()) + theme(axis.title.y=element_blank())+
theme(plot.margin=unit(c(0.5,0.5,1,1),"cm")) +
geom_rect(aes(xmin=30.192, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pTolCl <- pTolCl + theme(legend.position = "none") + theme(axis.title.x=element_blank()) +
theme(axis.title.y=element_blank()) + theme(plot.margin=unit(c(0.5,1.5,1.5,4),"cm")) +
geom_rect(aes(xmin=33.6, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCl <- pEvoCl + theme(axis.title.y=element_blank()) + theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(0.5,0.5,1.5,1),"cm")) +
geom_rect(aes(xmin=30.192, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvCh <- pEvCh + theme(legend.position = "none")
pEvCl <- pEvCl + theme(legend.position = "none")
pEvoCh <- pEvoCh + theme(legend.position = "none")
pEvoCl <- pEvoCl + theme(legend.position = "none")
pTolCh
pEvoCh
pTolCh <- Plot_two_curves_v0(spp1 = strio,spp2 = chir,locations = c("Toledo"),stri_values,chir_values,stri_GCOT,chir_GCOT,stri_m,chir_m,"orange")
pEvoCh <- Plot_two_curves_v0(spp1 = strio,spp2 = chir,locations = c("Evora"),stri_values,chir_values,stri_GCOT,chir_GCOT,stri_m,chir_m,"orange")
pTolCl <- Plot_two_curves_v0(spp1 = strio,spp2 = dipt,locations = c("Toledo"),stri_values,dipt_values,stri_GCOT,dipt_GCOT,stri_m,dipt_m,"pink")
pEvoCl <- Plot_two_curves_v0(spp1 = strio,spp2 = dipt,locations = c("Evora"),stri_values,dipt_values,stri_GCOT,dipt_GCOT,stri_m,dipt_m,"pink")
pTolCh <- pTolCh + ggtitle("Cool site (Toledo)") + theme(title=element_text(size=22)) + theme(plot.title = element_text(hjust=.5)) +
theme(axis.title.x=element_blank()) + theme(legend.position = "none") + theme(axis.title.y=element_blank()) +
#theme(plot.margin=unit(c(0.5,1.5,1,4),"cm")) +
geom_rect(aes(xmin=33.6, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCh <- pEvoCh + theme(axis.title.x=element_blank()) + theme(axis.title.y=element_blank())+
#theme(plot.margin=unit(c(0.5,0.5,1,1),"cm")) +
geom_rect(aes(xmin=30.192, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pTolCl <- pTolCl + theme(legend.position = "none") + theme(axis.title.x=element_blank()) +
theme(axis.title.y=element_blank()) + theme(plot.margin=unit(c(0.5,1.5,1.5,4),"cm")) +
geom_rect(aes(xmin=33.6, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCl <- pEvoCl + theme(axis.title.y=element_blank()) + theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(0.5,0.5,1.5,1),"cm")) +
geom_rect(aes(xmin=30.192, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCh <- pEvoCh + theme(legend.position = "none")
pEvoCl <- pEvoCl + theme(legend.position = "none")
pTolCh
pTolCl
pTolCh <- Plot_two_curves_v0(spp1 = strio,spp2 = chir,locations = c("Toledo"),stri_values,chir_values,stri_GCOT,chir_GCOT,stri_m,chir_m,"orange")
pEvoCh <- Plot_two_curves_v0(spp1 = strio,spp2 = chir,locations = c("Evora"),stri_values,chir_values,stri_GCOT,chir_GCOT,stri_m,chir_m,"orange")
pTolCl <- Plot_two_curves_v0(spp1 = strio,spp2 = dipt,locations = c("Toledo"),stri_values,dipt_values,stri_GCOT,dipt_GCOT,stri_m,dipt_m,"pink")
pEvoCl <- Plot_two_curves_v0(spp1 = strio,spp2 = dipt,locations = c("Evora"),stri_values,dipt_values,stri_GCOT,dipt_GCOT,stri_m,dipt_m,"pink")
pTolCh <- pTolCh + ggtitle("Cool site (Toledo)") + theme(title=element_text(size=22)) + theme(plot.title = element_text(hjust=.5)) +
theme(axis.title.x=element_blank()) + theme(legend.position = "none") + theme(axis.title.y=element_blank()) +
#theme(plot.margin=unit(c(0.5,1.5,1,4),"cm")) +
geom_rect(aes(xmin=33.6, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCh <- pEvoCh + theme(axis.title.x=element_blank()) + theme(axis.title.y=element_blank())+
#theme(plot.margin=unit(c(0.5,0.5,1,1),"cm")) +
geom_rect(aes(xmin=30.192, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pTolCl <- pTolCl + theme(legend.position = "none") + theme(axis.title.x=element_blank()) +
theme(axis.title.y=element_blank()) + #theme(plot.margin=unit(c(0.5,1.5,1.5,4),"cm")) +
geom_rect(aes(xmin=33.6, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCl <- pEvoCl + theme(axis.title.y=element_blank()) + theme(axis.title.x=element_blank())+
#theme(plot.margin=unit(c(0.5,0.5,1.5,1),"cm")) +
geom_rect(aes(xmin=30.192, xmax=45, ymin=-Inf, ymax=Inf), size = I(2), alpha = 0.2)
pEvoCh <- pEvoCh + theme(legend.position = "none")
pEvoCl <- pEvoCl + theme(legend.position = "none")
pTolCh
pTolCl
pEvoCh
pEvoCl
tiff("../Results/SchoolField/Revised/V0TolCh.tiff", width = 15, height = 15, units = 'cm', res = 300, compression = 'lzw')
print(pTolCh)
dev.off()
tiff("../Results/SchoolField/Revised/V0TolCl.tiff", width = 15, height = 15, units = 'cm', res = 300, compression = 'lzw')
print(pTolCl)
dev.off()
tiff("../Results/SchoolField/Revised/V0EvoCh.tiff", width = 15, height = 15, units = 'cm', res = 300, compression = 'lzw')
print(pEvoCh)
dev.off()
tiff("../Results/SchoolField/Revised/V0EvoCl.tiff", width = 15, height = 15, units = 'cm', res = 300, compression = 'lzw')
print(pEvoCh)
dev.off()
tiff("../Results/SchoolField/Revised/V0EvoCl.tiff", width = 15, height = 15, units = 'cm', res = 300, compression = 'lzw')
print(pEvoCl)
dev.off()
